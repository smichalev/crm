(function(e){function t(t){for(var a,s,i=t[0],l=t[1],c=t[2],d=0,p=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&p.push(n[s][0]),n[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],a=!0,i=1;i<r.length;i++){var l=r[i];0!==n[l]&&(a=!1)}a&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},n={app:0},o=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},3415:function(e,t,r){"use strict";var a=r("fec5"),n=r.n(a);n.a},"4a57":function(e,t,r){"use strict";var a=r("ead5"),n=r.n(a);n.a},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{staticStyle:{background:"#f1f1f1"}},[e.profile?r("v-navigation-drawer",{attrs:{clipped:e.clipped,fixed:"",app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("sidebar")],1):e._e(),r("v-app-bar",{attrs:{"clipped-left":e.clippedleft,fixed:"",app:"",dense:"",color:"#177758",elevation:"0"}},[e.profile?r("v-btn",{staticClass:"d-lg-none d-xl-none mr-2",attrs:{icon:"",color:"#fff"},on:{click:function(t){t.stopPropagation(),e.rightDrawer=!e.rightDrawer}}},[r("v-icon",[e._v("mdi-menu")])],1):e._e(),r("logo"),r("v-spacer"),e.profile?r("v-toolbar-items",{staticStyle:{height:"48px"}},[r("v-menu",{attrs:{"offset-y":"",bottom:"",right:"",transition:"slide-y-transition"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[r("v-btn",e._g({attrs:{text:"",dark:"",elevation:"0"}},a),[r("div",{staticClass:"d-sm-flex ml-2",staticStyle:{"flex-direction":"column"}},[r("div",{staticClass:"desktop"},[e._v(e._s(e.username.desktop))]),r("div",{staticClass:"mobile"},[e._v(e._s(e.username.mobile))]),r("div",{staticStyle:{"font-size":"12px"}},[e._v(e._s(e.user_role))])]),r("v-icon",{staticClass:"desktop",attrs:{small:""}},[e._v("mdi-chevron-down")])],1)]}}],null,!1,746884598)},[r("v-list",[r("v-list-item",{on:{click:e.logout}},[r("v-list-item-title",[e._v(" Выход ")])],1)],1)],1)],1):e._e()],1),r("v-content",{staticStyle:{width:"100%"},attrs:{fluid:""}},[r("router-view")],1),e.profile?r("v-navigation-drawer",{attrs:{right:e.right,temporary:"",fixed:""},model:{value:e.rightDrawer,callback:function(t){e.rightDrawer=t},expression:"rightDrawer"}},[r("sidebar")],1):e._e()],1)},o=[],s=(r("b0c0"),r("ac1f"),r("1276"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"logotype",on:{click:e.logo}},[e._v(" crm ")])}),i=[],l={methods:{logo:function(){"/"!==this.$route.path&&this.$router.push("/")}}},c=l,u=(r("3415"),r("2877")),d=Object(u["a"])(c,s,i,!1,null,"b988dcf6",null),p=d.exports,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",e._l(e.menuBar,(function(t,a){return r("div",{key:a},[r("div",{staticClass:"mt-2 mx-2",staticStyle:{"text-transform":"uppercase"}},[r("span",[e._v(e._s(t.title))])]),r("v-list",e._l(t.item,(function(t,a){return r("v-list-item",{key:a,attrs:{to:t.to,dense:""}},[r("v-list-item-action",[r("v-icon",[e._v(e._s(t.icon))])],1),r("v-list-item-content",[r("v-list-item-title",{domProps:{textContent:e._s(t.title)}})],1)],1)})),1)],1)})),0)},v=[],m={data:function(){return{menuBar:[{title:"Меню",item:[{title:"Главная страница",icon:"mdi-server",to:"/"}]}]}}},h=m,b=Object(u["a"])(h,f,v,!1,null,null,null),_=b.exports,g={name:"App",components:{logo:p,sidebar:_},data:function(){return{drawer:!0,clipped:!0,clippedleft:!0,right:!1,rightDrawer:!1}},mounted:function(){var e=this;return this.$http.get(this.$address+"/profile").then((function(t){t.data.profile||"/"!==e.$route.path||e.$router.push("/login"),t.data.profile&&(e.$store.commit("LOGIN",t.data.profile),e.$router.push("/"))}))},methods:{logout:function(){var e=this;return this.$http.post(this.$address+"/logout").then((function(){e.$store.commit("LOGOUT"),e.$router.push("/login")}))}},computed:{username:function(){for(var e="",t=this.$store.state.auth.profile.name.split(" "),r=0;r<t.length;r++)e+=0===r?t[r]:" "+t[r][0]+".";return{desktop:this.$store.state.auth.profile.name,mobile:e}},user_role:function(){var e=null;switch(this.$store.state.auth.profile.role){case"storekeeper":e="Кладовщик";break;case"accountant":e="Бухгалтер";break;case"operator":e="Оператор";break;case"route_manager":e="Диспетчер маршрутов";break;case"sales_manager":e="Менеджер по продажам";break;case"director":e="Директор";break;case"admin":e="Администратор";break}return e},profile:function(){return this.$store.state.auth.profile}}},w=g,y=(r("4a57"),Object(u["a"])(w,n,o,!1,null,"a0c6a020",null)),x=y.exports,k=(r("99af"),r("2909")),$=r("8c4f"),O=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{staticClass:"my-4 mx-4",attrs:{elevation:"0",outlined:""}},[r("v-card-title",[e._v("Добро пожаловать, "+e._s(e.$store.state.auth.profile.name)+"!")]),r("v-card-text",[e._v("Тут будет много чего интересного")])],1)},j=[],S={},C=Object(u["a"])(S,O,j,!1,null,null,null),L=C.exports,P=[{path:"/",name:"index",component:L}],R=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[r("v-row",{attrs:{align:"center",justify:"center"}},[r("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[r("v-card",[r("v-toolbar",{attrs:{color:"#177758",dark:"",flat:""}},[r("v-toolbar-title",[e._v("Авторизация")])],1),r("v-card-text",[e.errorList.length?r("v-alert",{attrs:{color:"error",text:"",dense:""}},e._l(e.errorList,(function(t,a){return r("div",{key:a},[e._v(" "+e._s(t)+" ")])})),0):e._e(),r("v-select",{staticClass:"mb-3",attrs:{label:"Выберите роль",items:e.roles,"item-value":"value","item-text":"name",outlined:"",dense:"","return-object":"","hide-details":"",color:"#177758"},scopedSlots:e._u([{key:"selection",fn:function(t){var r=t.item;return[e._v(" "+e._s(r.name)+" ")]}},{key:"item",fn:function(t){var r=t.item;return[e._v(" "+e._s(r.name)+" ")]}}]),model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}}),r("v-select",{staticClass:"mb-3",attrs:{items:e.users,label:"Выберите пользователя",outlined:"",dense:"","hide-details":"",color:"#177758",disabled:!e.selectedRole},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),r("v-text-field",{attrs:{label:"Пароль",outlined:"",dense:"",color:"#177758",type:"password","hide-details":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),r("v-divider"),r("v-card-actions",[r("v-btn",{attrs:{elevation:"0",color:"success",block:"",disabled:!e.disabledBtn},on:{click:e.authorization}},[e._v("Войти")])],1)],1)],1)],1)],1)},D=[],E={name:"index",data:function(){return{name:"",password:"",errorList:[],selectedRole:null,roles:[{value:"storekeeper",name:"Кладовщик"},{value:"accountant",name:"Бухгалтер"},{value:"operator",name:"Оператор"},{value:"route_manager",name:"Диспетчер маршрутов"},{value:"sales_manager",name:"Менеджер по продажам"},{value:"director",name:"Директор"},{value:"admin",name:"Администратор"}],users:[]}},methods:{authorization:function(){var e=this;return this.errorList=[],this.$http.post(this.$address+"/login",{name:this.name,role:this.selectedRole.value,password:this.password}).then((function(t){t.data.profile&&t.data.profile._id&&(e.$store.commit("LOGIN",t.data.profile),e.$router.push("/"))})).catch((function(t){e.name="",e.selectedRole=null,e.password="",e.errorList.push(t.response.data.error.message)}))},getUser:function(e){var t=this;return this.errorList=[],this.users=[],this.$http.get(this.$address+"/roles?role="+e).then((function(e){t.users=e.data.users})).catch((function(e){return t.errorList.push(e.response.data.error.message)}))}},watch:{selectedRole:function(e){this.getUser(e.value)}},computed:{disabledBtn:function(){return this.name.length&&this.password.length&&this.selectedRole}},mounted:function(){this.$store.state.auth.profile&&this.$router.push("/")}},G=E,T=Object(u["a"])(G,R,D,!1,null,null,null),B=T.exports,M=[{path:"/login",name:"login",component:B}];a["default"].use($["a"]);var U=new $["a"]({mode:"history",routes:[].concat(Object(k["a"])(P),Object(k["a"])(M))}),z=r("2f62"),I={profile:null},N={profile:function(e){return e.profile}},J={LOGIN:function(e,t){I.profile=t},LOGOUT:function(e){e.profile=null}},A={state:I,getters:N,mutations:J};a["default"].use(z["a"]);var q=new z["a"].Store({modules:{auth:A}}),F=r("ce5b"),H=r.n(F);r("bf40"),r("8b9f");a["default"].use(H.a);var K={},Q=new H.a(K),V=r("bc3a"),W=r.n(V);W.a.defaults.withCredentials=!0;var X=W.a;a["default"].prototype.$http=X,a["default"].prototype.$address="http://78.24.220.136:3333/api",a["default"].config.productionTip=!1,new a["default"]({router:U,store:q,vuetify:Q,render:function(e){return e(x)}}).$mount("#app")},ead5:function(e,t,r){},fec5:function(e,t,r){}});
//# sourceMappingURL=app.210f5448.js.map